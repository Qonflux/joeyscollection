import{_ as z,t as r,v as d,L as P,r as g,x as t,y as _,B as $,M as D,N as k,O as B,P as a,m as G,Q as L,R as O,S as A,T as R,U as C,l as U}from"./mXEionkS.js";const j={props:{size:{type:[Number,String],default:1.5},lineSize:{type:[Number,String],default:.25},lineBgColor:{type:String,default:"#eee"},lineFgColor:{type:String,default:"#7C3AED"},speed:{type:[Number,String],default:.8}},computed:{spinnerStyle(){return{margin:"0 auto","border-radius":"100%",border:this.lineSize+"rem solid "+this.lineBgColor,"border-top":this.lineSize+"rem solid "+this.lineFgColor,width:this.size+"rem",height:this.size+"rem",animation:"spinner-spin "+this.speed+"s linear infinite"}}}};function M(w,m,u,n,h,p){return r(),d("div",{class:"spinner",style:P(p.spinnerStyle)},null,4)}const V=z(j,[["render",M]]),X=["src"],F={class:"mt-3"},q={class:"mt-3"},W={key:0},Y={class:"mt-3"},Q=t("p",{class:"mt-3 mb-1"},"Platform:",-1),Z=["value"],H=["value"],J=["value"],K=t("label",{for:"completed",class:"text-sm"}," Uitgespeeld",-1),ee=t("br",null,null,-1),te={__name:"GameDetail",props:{game:{type:Object,required:!0},systems:{type:Array,required:!0}},emits:["update-platform","update-completed"],setup(w,{emit:m}){const{$showToast:u}=G(),n=w,h=m,p=g(["Nintendo Entertainment System (NES)","Super Nintendo Entertainment System (SNES)","Nintendo 64","Nintendo GameCube","Wii","Wii U","Nintendo Switch","Game Boy","Game Boy Color","Game Boy Advance","Nintendo DS","Nintendo 3DS","PlayStation","PlayStation 2","PlayStation 3","PlayStation 4","Xbox","Xbox 360","Xbox One","Sega Mega Drive"]),y=i=>{const e=i.target.options[i.target.options.selectedIndex].text;h("update-platform",e)},S=async()=>{try{await $fetch("/api/games",{method:"POST",body:{...n.game}}),u("Game succesvol toegevoegd","info")}catch(i){console.error(i)}};return(i,e)=>(r(),d(k,null,[t("h2",null,_(n.game.name),1),t("img",{src:n.game.cover},null,8,X),t("p",F,"Release: "+_(n.game.releaseDate),1),t("p",q,[$("Genre"),n.game.genres.length<1?(r(),d("span",W,"s")):D("",!0),$(": "+_(n.game.genres.join(", ")),1)]),t("p",Y,"Beschikbaar op: "+_(n.systems.join(", ")),1),Q,t("select",{id:"plaform",value:n.game.platform,name:"plaform",class:"block p-4 pr-8 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-violet-600 focus:border-violet-600",onInput:e[0]||(e[0]=c=>y(c))},[(r(!0),d(k,null,B(a(p),c=>(r(),d("option",{key:c,value:c},_(c),9,H))),128))],40,Z),t("input",{id:"completed",value:n.game.completed,type:"checkbox",class:"mt-3",onInput:e[1]||(e[1]=c=>h("update-completed",c))},null,40,J),K,ee,t("button",{class:"bg-violet-600 hover:bg-violet-800 rounded-md font-bold py-2 px-4 my-3 transition duration-200",onClick:S}," Toevoegen ")],64))}},ne=te,se={class:"relative mb-4"},oe=t("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[t("svg",{"aria-hidden":"true",class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),ae={key:1,class:"text-sm"},re=t("h2",null,"Gevonden games:",-1),le=["onClick"],ie=t("br",null,null,-1),de={__name:"index",setup(w){const m=U(),u=g(""),n=g([]),h=g(null),p=g(null),y=g(!1),S={completed:!1,cover:null,genres:[],igdbId:null,name:null,platform:"Nintendo Switch",releaseDate:null},i=g([]),e=L({...S}),c=async s=>{var f;e.igdbId=s.id,e.name=s.name,e.releaseDate=N(s.first_release_date);const l=await x("covers",`fields url; where id = ${s.cover};`);e.cover=(f=l[0])==null?void 0:f.url.replace("thumb","cover_big"),s.genres.forEach(b=>{setTimeout(async()=>{var v;const o=await x("genres",`fields name; where id = ${b};`);e.genres.push((v=o[0])==null?void 0:v.name)},250)}),i.value=[],s.platforms.forEach(b=>{setTimeout(async()=>{var v;const o=await x("platforms",`fields name; where id = ${b};`);i.value.push((v=o[0])==null?void 0:v.name)},250)})},N=s=>(s=new Date(Number(s*1e3)),s.toLocaleDateString("nl-NL",{day:"2-digit",month:"2-digit",year:"numeric"})),I=s=>s.split("-")[2],T=async()=>{u.value.length<3||(y.value=!0,clearTimeout(h.value),h.value=setTimeout(async()=>{E(),n.value=await x("games",`fields name,cover,first_release_date,genres,platforms; search "${u.value}"; limit 50;`),y.value=!1},250))},E=()=>{Object.assign(e,S),e.genres=[]},x=async(s,l)=>{try{return p.value||({access_token:p.value}=await $fetch(`https://id.twitch.tv/oauth2/token?client_secret=${m.public.IGDB_CLIENT_SECRET}&client_id=${m.public.IGDB_CLIENT_ID}&grant_type=client_credentials`,{method:"POST"})),await $fetch(`${m.public.PROXY}https://api.igdb.com/v4/${s}`,{method:"POST",headers:{"Client-ID":m.public.IGDB_CLIENT_ID,Authorization:`Bearer ${p.value}`},body:l})}catch(f){console.error(f)}};return(s,l)=>{const f=V,b=ne;return r(),d("div",null,[t("div",se,[oe,O(t("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>R(u)?u.value=o:null),type:"search",class:"block p-4 pl-10 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-violet-600 focus:border-violet-600",placeholder:"Zoek spel",onInput:T},null,544),[[A,a(u)]])]),a(y)?(r(),C(f,{key:0,size:"3","line-size":"0.375"})):a(n)&&a(n).length>0&&!a(e).igdbId?(r(),d("div",ae,[re,(r(!0),d(k,null,B(a(n),o=>(r(),d("a",{key:o.id,onClick:v=>c(o)},[$(_(o.name)+" ("+_(I(N(o.first_release_date)))+")",1),ie],8,le))),128))])):a(e).igdbId?(r(),C(b,{key:2,game:a(e),systems:a(i),class:"mt-4 text-sm",onUpdatePlatform:l[1]||(l[1]=o=>a(e).platform=o),onUpdateCompleted:l[2]||(l[2]=o=>a(e).completed=!a(e).completed)},null,8,["game","systems"])):D("",!0)])}}};export{de as default};
