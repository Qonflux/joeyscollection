import{_ as C,o as l,c as d,n as O,u as B,a as A,r as u,b as t,t as g,d as E,e as N,F as k,f as P,g as $,w as j,v as U,h as G}from"./entry-8e6d833f.mjs";const R={props:{size:{type:[Number,String],default:1.5},lineSize:{type:[Number,String],default:.25},lineBgColor:{type:String,default:"#eee"},lineFgColor:{type:String,default:"#7C3AED"},speed:{type:[Number,String],default:.8}},computed:{spinnerStyle(){return{margin:"0 auto","border-radius":"100%",border:this.lineSize+"rem solid "+this.lineBgColor,"border-top":this.lineSize+"rem solid "+this.lineFgColor,width:this.size+"rem",height:this.size+"rem",animation:"spinner-spin "+this.speed+"s linear infinite"}}}};function F(h,n,i,e,m,c){return l(),d("div",{class:"spinner",style:O(c.spinnerStyle)},null,4)}var V=C(R,[["render",F]]);const X={__name:"GameDetail",props:{game:{type:Object,required:!0},systems:{type:Array,required:!0}},emits:["update-platform","update-completed"],setup(h,{expose:n,emit:i}){n();const e=h,m=B(),{$showToast:c}=A(),o=u(["Nintendo Entertainment System (NES)","Super Nintendo Entertainment System (SNES)","Nintendo 64","Nintendo GameCube","Wii","Wii U","Nintendo Switch","Game Boy","Game Boy Color","Game Boy Advance","Nintendo DS","Nintendo 3DS","PlayStation","PlayStation 2","PlayStation 3","PlayStation 4","Xbox","Xbox 360","Xbox One","Sega Mega Drive"]),p={config:m,$showToast:c,props:e,emit:i,platforms:o,onChange:s=>{const b=s.target.options[s.target.options.selectedIndex].text;i("update-platform",b)},addGame:async()=>{try{await $fetch(`${m.public.API_URL}/api/games`,{method:"POST",body:{...e.game}}),c("Game succesvol toegevoegd","info")}catch(s){console.error(s)}}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},M=["src"],Y={class:"mt-3"},q={class:"mt-3"},W=N("Genre"),Z={key:0},H={class:"mt-3"},J=t("p",{class:"mt-3 mb-1"},"Platform:",-1),K=["value"],Q=["value"],ee=["value"],te=t("label",{for:"completed",class:"text-sm"}," Uitgespeeld",-1),ne=t("br",null,null,-1);function oe(h,n,i,e,m,c){return l(),d(k,null,[t("h2",null,g(e.props.game.name),1),t("img",{src:e.props.game.cover},null,8,M),t("p",Y,"Release: "+g(e.props.game.releaseDate),1),t("p",q,[W,e.props.game.genres.length<1?(l(),d("span",Z,"s")):E("",!0),N(": "+g(e.props.game.genres.join(", ")),1)]),t("p",H,"Beschikbaar op: "+g(e.props.systems.join(", ")),1),J,t("select",{id:"plaform",value:e.props.game.platform,name:"plaform",class:"block p-4 pr-8 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-violet-600 focus:border-violet-600",onInput:n[0]||(n[0]=o=>e.onChange(o))},[(l(!0),d(k,null,P(e.platforms,o=>(l(),d("option",{key:o,value:o},g(o),9,Q))),128))],40,K),t("input",{id:"completed",value:e.props.game.completed,type:"checkbox",class:"mt-3",onInput:n[1]||(n[1]=o=>e.emit("update-completed",o))},null,40,ee),te,ne,t("button",{class:"bg-violet-600 hover:bg-violet-800 rounded-md font-bold py-2 px-4 my-3 transition duration-200",onClick:e.addGame}," Toevoegen ")],64)}var ae=C(X,[["render",oe]]);const re={__name:"index",setup(h,{expose:n}){n();const i=B(),e=u(""),m=u([]),c=u(null),o=u(null),_=u(!1),a={completed:!1,cover:null,genres:[],igdbId:null,name:null,platform:"Nintendo Switch",releaseDate:null},p=u([]),s=$({...a}),b=async r=>{var y;s.igdbId=r.id,s.name=r.name,s.releaseDate=D(r.first_release_date);const S=await f("covers",`fields url; where id = ${r.cover};`);s.cover=(y=S[0])==null?void 0:y.url.replace("thumb","cover_big"),r.genres.forEach(x=>{setTimeout(async()=>{var v;const w=await f("genres",`fields name; where id = ${x};`);s.genres.push((v=w[0])==null?void 0:v.name)},250)}),p.value=[],r.platforms.forEach(x=>{setTimeout(async()=>{var v;const w=await f("platforms",`fields name; where id = ${x};`);p.value.push((v=w[0])==null?void 0:v.name)},250)})},D=r=>(r=new Date(Number(r*1e3)),r.toLocaleDateString("nl-NL",{day:"2-digit",month:"2-digit",year:"numeric"})),z=r=>r.split("-")[2],L=async()=>{e.value.length<3||(_.value=!0,clearTimeout(c.value),c.value=setTimeout(async()=>{I(),m.value=await f("games",`fields name,cover,first_release_date,genres,platforms; search "${e.value}"; limit 50;`),_.value=!1},250))},I=()=>{Object.assign(s,a),s.genres=[]},f=async(r,S)=>{try{return o.value||({access_token:o.value}=await $fetch(`https://id.twitch.tv/oauth2/token?client_secret=${i.public.IGDB_CLIENT_SECRET}&client_id=${i.public.IGDB_CLIENT_ID}&grant_type=client_credentials`,{method:"POST"})),await $fetch(`${i.public.PROXY}/https://api.igdb.com/v4/${r}`,{method:"POST",headers:{"Client-ID":i.public.IGDB_CLIENT_ID,Authorization:`Bearer ${o.value}`},body:S})}catch(y){console.error(y)}},T={config:i,searchTerm:e,foundGames:m,debounce:c,token:o,isLoadingSearch:_,defaultGame:a,platforms:p,game:s,getGame:b,convertDate:D,extractYear:z,searchGame:L,resetGame:I,fetchApi:f};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}},se={class:"relative mb-4"},ie=t("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[t("svg",{"aria-hidden":"true",class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),le={key:1,class:"text-sm"},ce=t("h2",null,"Gevonden games:",-1),de=["onClick"],me=t("br",null,null,-1);function pe(h,n,i,e,m,c){const o=V,_=ae;return l(),d("div",null,[t("div",se,[ie,j(t("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>e.searchTerm=a),type:"search",class:"block p-4 pl-10 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-violet-600 focus:border-violet-600",placeholder:"Zoek spel",onInput:e.searchGame},null,544),[[U,e.searchTerm]])]),e.isLoadingSearch?(l(),G(o,{key:0,size:"3","line-size":"0.375"})):e.foundGames&&e.foundGames.length>0&&!e.game.igdbId?(l(),d("div",le,[ce,(l(!0),d(k,null,P(e.foundGames,a=>(l(),d("a",{key:a.id,onClick:p=>e.getGame(a)},[N(g(a.name)+" ("+g(e.extractYear(e.convertDate(a.first_release_date)))+")",1),me],8,de))),128))])):e.game.igdbId?(l(),G(_,{key:2,game:e.game,systems:e.platforms,class:"mt-4 text-sm",onUpdatePlatform:n[1]||(n[1]=a=>e.game.platform=a),onUpdateCompleted:n[2]||(n[2]=a=>e.game.completed=!e.game.completed)},null,8,["game","systems"])):E("",!0)])}var ge=C(re,[["render",pe]]);export{ge as default};
